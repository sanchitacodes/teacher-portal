<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Teacher Dashboard</title>
</head>
<body>
  <h2>Upload Marks</h2>
  <form id="uploadMarksForm">
    <input type="text" name="roll_no" placeholder="Roll Number" required />
    <input type="number" name="marks" placeholder="Marks" required />
    <button type="submit">Upload</button>
  </form>

  <script>
  const urlParams = new URLSearchParams(window.location.search);
  const teacher_id = urlParams.get('teacher_id');

  const BASE_URL = window.location.hostname === "localhost"
    ? "http://localhost:3000"
    : "https://teacher-portal-3.onrender.com"; // Render backend URL

  document.getElementById("uploadMarksForm").addEventListener("submit", async e => {
    e.preventDefault();
    const form = e.target;
    const roll_no = form.querySelector('input[name="roll_no"]').value;
    const marks = parseInt(form.querySelector('input[name="marks"]').value);

    const data = {
      teacher_id,
      marks: [{ roll_no, marks }]
    };

    try {
      const res = await fetch(`${BASE_URL}/teacher/upload`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      const result = await res.json();
      alert(result.message || "Marks uploaded");
    } catch (err) {
      console.error(err);
      alert("Error uploading marks");
    }
  });
</script>

</body>
</html>
